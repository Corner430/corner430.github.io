---
title: vim学习
date: 2023-06-08 10:07:14
tags:
declare: true
---
## 教程

[Vimtutor_1.5](http://www2.geog.ucl.ac.uk/~plewis/teaching/unix/vimtutor)
[vimtutor](https://vimhelp.org/usr_01.txt.html#vimtutor)：有一些书籍进行推荐，还有电子版
[VIM无废话极简入门](https://www.bilibili.com/video/BV1qg4y13766/?spm_id_from=333.880.my_history.page.click&vd_source=2dd00fcea46a9c5a26706a99eb12ea3f)
《Vim实用技巧》
《精通vim》
[lazyvim](https://github.com/LazyVim/LazyVim)
[Vimium](https://github.com/philc/vimium)
[Vimium-c](https://github.com/gdh1995/vimium-c)

- 下载最新中文版本的vimtutor
`vim --clean -c 'e $VIMRUNTIME/tutor/tutor.zh_cn.utf-8' -c 'w! TUTORCOPY' -c 'q'`<!--more-->

------------------------------
## Vim 使用技巧

### 常用命令

- `W`或`E`或`B` 逐个广义单词移动
- `{` 或 `}` 逐个段落移动
- `b` 回退
- `0` 或者 `^` 行首
- `t`或`f` 在行内查找下一指定字符
- `T`或`F` 在行内查找上一指定字符
- `di` 删除范围内的字符
- `da` 删除范围内的字符(包括范围字符)
- `zz` 回到文本中部
- `:num` 等同于 `num G`
- `:+num` 向下移动 num 行
- `:-num` 向上移动 num 行
- `#` 在当前光标所在单词上按`#`，进入查找该单词状态
- `:%s/old/new` 全局替换
- `:34s/old/new` 替换第34行的字符
- `:34,40s/old/new` 替换第34到40行的字符
- `:10,20/your_search_term` 在第10到20行搜索
- `/hel.\{1,3\}` 正则表达式搜索
    - `hel`：匹配字母 "hel" 作为开头。
    - `.`：匹配除换行符外的任意字符。
    - `\{1,3\}`：表示前一个字符或子表达式的重复次数范围。这里指定了 1 到 3 次重复，表示匹配一个到三个任意字符。
- `yj` 复制下一行
- `yi` 范围复制
- `ya` 范围复制(包括范围字符)
- `P` 前粘贴
- `v` 普通可视化
- `V` 行可视化
- `Ctrl + v` (矩形)块可视化
- `Ctrl + G` 显示当前行号、列号及文件信息
- `;` 快速跳转到下一个与当前光标位置处的字符匹配的位置的命令。
- `,` 快速跳转到上一个与当前光标位置处的字符匹配的位置的命令。
- `/` 向下查找
- `?` 向上查找
- `&` 重复上一次使用 `:s` 命令执行的替换操作
- `qx{changes}q` 录制宏
- `*` 在当前光标所在单词上按`*`，进入查找该单词状态。**并且会高亮显示所有匹配的单词，如果没有高亮，可以使用`:set hls`命令开启高亮显示。**
- `cc` 清除整行，然后进入插入模式。保持原来的缩进。
- `Shift + (` 和 `Shift + )` 分别将光标移动到上一句和下一句的开头。
- `H` 将光标移动到屏幕的顶部。
- `L` 将光标移动到屏幕的底部。
- `:term[inal]` 打开终端

--------------------------------------------------
### 一箭双雕

- `>G` 增加从当前行到文档末尾处的缩进层级
- `.` 重复上一次修改

一箭双雕
| 复合命令 | 等效的长命令 |
| :--- | :---: |
| C | c$ |
| s | cl |
| S | ^C |
| I | ^i |
| o | A<CR> |
| O | ko |
> 这些命令的共同点：都会从普通模式切换到插入模式，这将会对`.`命令产生影响。

-------------------------------------
### Vim 使用技巧

`.` 命令是一个微型的宏，Vim可以录制任意数目的按键操作，然后在以后重复执行它们。这让我们可以把最常重复的工作流程录制下来，并用一个按键重放它们。


--------------------------------
### Vim 宏

`qx{changes}q` 是一个 Vim 中用于记录和执行宏的命令序列。这个命令由以下三部分组成：

1. `qx`：这是开始记录宏的命令。`q` 是录制宏的起始命令，后面的 `x` 是宏的名称，你可以使用任何字母来表示宏的名称。例如，你可以使用 `qa`、`qb` 等来表示不同的宏。

2. `{changes}`：这是你要录制的一系列文本编辑操作，包括移动光标、删除、插入、替换等。你可以在这个部分中执行任何你希望录制的编辑操作。

3. `q`：这是结束宏录制的命令。当你完成了要录制的编辑操作后，按下 `q` 来停止录制。

一旦你录制了宏，你可以使用 `@x` 来执行宏，其中 `x` 是你为宏指定的名称。例如，如果你录制了一个名为 `q` 的宏，你可以使用 `@q` 来执行宏中包含的操作，这将重复宏中的所有编辑操作。

以下是一个示例：

1. 打开一个文本文件并将光标移动到要编辑的文本位置。

2. 输入 `qx` 开始录制一个宏，然后执行一系列编辑操作，例如删除一行、插入文本、替换文本等。

3. 输入 `q` 来停止录制宏。

4. 现在，你可以使用 `@x` 来执行宏，其中 `x` 是你为宏指定的名称（在这个示例中是 `q`）。执行宏将重复你录制的所有编辑操作。

这是 Vim 中非常强大的功能，因为它允许你自动执行一系列复杂的编辑操作，而不必手动重复这些操作。这对于批量编辑和自动化编辑任务非常有用。

------------------------------------
## Vim 8 文本处理实战
### .vimrc 配置

```vim
syntax on                   " 支持语法高亮显示
filetype plugin indent on   " 启用根据文件类型自动缩进

set autoindent              " 开始新行时处理缩进
set expandtab               " 将制表符 Tab 展开为空格，这对于 Python 尤其有用
set tabstop=4               " 要计算的空格数
set shiftwidth=4            " 用于自动缩进的空格数

set backspace=2             " 在多数终端上修正退格键 Backspace 的行为

colorscheme murphy          " 修改配色

set number                  " 显示行号
```

`set relativenumber` 设置相对行号

------------------------------------
### 撤销历史记录

set undofile                " 启用撤销文件，这样即使在关闭 Vim 后也可以撤销
不过，这会在系统中为每个被编辑过的文件保留一个撤销历史记录文件，显得有些混乱。也可以将这些文件保存在同一个目录中，配置如下所示：
    
    ```vim
    set undofile
    if !isdirectory("$HOME/.vim/undodir")
        call mkdir("$HOME/.vim/undodir", "p")
    endif
    set undodir="$HOME/.vim/undodir"
    ```

-------------------------------------
### 查看帮助文档

`:h cc` 查看 `cc` 命令的帮助文档

-----------------------------------
### 插件

- 创建一个存储插件的目录 `mkdir -p ~/.vim/pack/plugins/start`
- 使 Vim 能够自动加载每个插件的文档（Vim 默认不会这么做）。在 `~/.vim/vimrc` 中添加以下内容：
    ```vim
    packloadall             " 加载所有插件
    silent! helptags ALL    " 为所有插件加载帮助文档
    ```

`unimpaired` 插件，它为很多内置命令（以及一些新的命令）添加映射

--------------------------------------
### 缓冲区
`:ls` 或 `buffers` 或 `files` 查看缓冲区列表
`:e example.txt` 打开一个新文件或者切换到一个已存在的文件
`:b [number]/[filename]` 切换到指定的缓冲区（空格可省略，tab可用于补全）
`:bn(:bnext)` 和 `bp(:bprevious)` 循环遍历缓冲区
`:bd` 关闭当前缓冲区

--------------------------------------
### 窗口
`:sp[lit] filename` 水平分割窗口
`:vs[plit] filename` 垂直分割窗口
`:q` 关闭当前窗口
`:on[ly]` 关闭所有窗口，只保留当前窗口

> 通过组合 `:split` 和 `:vsplit`，可以生成任意多个窗口。

**使用 `Ctrl + w` + `h/j/k/l` 在窗口之间移动**

#### 窗口的移动
`Ctrl + w` + `H/J/K/L` 将当前窗口移动到屏幕的左/下/上/右侧

> **窗口编号顺序为由由上至下、由左至右递增**

#### 改变窗口的大小

------------------------------------------
### 折叠
- 在 .vimrc 文件中将 `foldmethod` 设置为 `indent`：`set foldmethod=indent`
- `zo` 打开当前行折叠
- `zc` 关闭当前折叠块
- `za` 打开或关闭当前折叠块
- `zR` 打开所有折叠块
- `zM` 关闭所有折叠块

> vim支持多种折叠方式

----------------------------------

### 文件树
#### 目录浏览器 Netrw
Netrw 是 Vim 自带的一个插件，支持对目录和文件的浏览，使用方法为 `:EX[plore]` 或 `:e`

#### 支持文件菜单的 `:e` 命令
首先在 .vimrc 中添加以下配置：

```vim
    set wildmenu                        " 启用增强的 Tab 自动补全
    set wildmode=list:longest,full      " 补全为允许的最长字符串，然后打开 wildmenu
```

#### 插件 NERDTree
偏图形化

#### 插件 Vinegar
**用于解决项目侧边栏与分割窗口无法同时工作的问题。**

#### 插件 CtrlP
**CtrlP 是一个模糊补全插件**，可帮助读者在只知道部分关键字时快速打开所需文件。

------------------------------------
### 搜索
- `:grep` 和 `:vimgrep`
- `ack`

#### 插件 EasyMotion

--------------------------------------
### 寄存器
- 默认寄存器：`""`，存储最近的复制和剪切操作的文本，使用 `y` 复制和 `d` 剪切，然后使用 `p` 粘贴。
- 命名寄存器：由大写字母和数字标识，如 `"a` 或 `"1`，用于存储和检索特定文本。例如，`"ayw` 复制单词到 `"a` 寄存器，然后使用 `"ap` 粘贴。
- 黑洞寄存器：`"_`，用于丢弃文本，特别适用于删除文本但不保存在其他寄存器中。
- 操作寄存器：使用 `"` 后跟寄存器标识符来选择要使用的寄存器，例如 `"a` 表示使用 `"a` 寄存器。
- 查看寄存器内容：使用 `:reg` 命令，如 `:reg a` 查看 `"a` 寄存器的内容。

#### 从外部复制文本到vim中
```vim
set clipboard=unamed                " 复制到系统寄存器(*)
set clipboard=unnamedplus           " 复制到系统寄存器(+)
set clipboard=unnamed,unnamedplus   " 复制到系统寄存器(*, +)
```

------------------------------------
### 插件管理
#### 插件管理器 vim-plug
#### Vundle

> 分析运行慢的插件

-------------------------
### 自动补全
#### 内置自动补全
- `Ctrl + n` 和 `Ctrl + p`：在当前文件中搜索匹配的单词。
- 插入补全模式

#### YouCompleteMe 插件
